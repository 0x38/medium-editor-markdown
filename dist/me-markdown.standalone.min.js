!function(e){if("function"!=typeof MediumEditor)throw new Error("Medium Editor is not loaded on the page.");var n=function(e,n){if(!e)return n;var t,r={};for(t in n)r[t]=has(e,t)?e[t]:n[t];return r},t=function(e,n){var t="";return e>=55296&&57343>=e||e>1114111?(n&&r("character reference outside the permissible Unicode range"),"ï¿½"):has(decodeMapNumeric,e)?(n&&r("disallowed character reference"),decodeMapNumeric[e]):(n&&contains(invalidReferenceCodePoints,e)&&r("disallowed character reference"),e>65535&&(e-=65536,t+=stringFromCharCode(e>>>10&1023|55296),e=56320|1023&e),t+=stringFromCharCode(e))},r=function(e){throw Error("Parse error: "+e)},a=function(e,c){c=n(c,a.options);var i=c.strict;return i&&regexInvalidEntity.test(e)&&r("malformed character reference"),e.replace(regexDecode,function(e,n,a,o,l,s,p,u){var f,m,d,h,g;return n?(f=n,m=a,i&&!m&&r("character reference was not terminated by a semicolon"),t(f,i)):o?(d=o,m=l,i&&!m&&r("character reference was not terminated by a semicolon"),f=parseInt(d,16),t(f,i)):s?(h=s,has(decodeMap,h)?decodeMap[h]:(i&&r("named character reference was not terminated by a semicolon"),e)):(h=p,g=u,g&&c.isAttributeValue?(i&&"="==g&&r("`&` did not start a character reference"),e):(i&&r("named character reference was not terminated by a semicolon"),decodeMapLegacy[h]+(g||"")))})},c={decode:a},i=function(e){function n(e,n){var t="void"===n.type?"<"+n.tag+"\\b([^>]*)\\/?>":"<"+n.tag+"\\b([^>]*)>([\\s\\S]*?)<\\/"+n.tag+">",r=new RegExp(t,"gi"),a="";return a="string"==typeof n.replacement?e.replace(r,n.replacement):e.replace(r,function(e,t,r,a){return n.replacement.call(this,e,t,r,a)})}function t(e){return new RegExp(e+"\\s*=\\s*[\"']?([^\"']*)[\"']?","i")}function r(e){return e=e.replace(/<(ul|ol)\b[^>]*>([\s\S]*?)<\/\1>/gi,function(e,n,t){var r=t.split("</li>");for(r.splice(r.length-1,1),l=0,s=r.length;s>l;l++){if(r[l]){var a="ol"===n?l+1+".  ":"*   ";r[l]=r[l].replace(/\s*<li[^>]*>([\s\S]*)/i,function(e,n){return n=n.replace(/^\s+/,""),n=n.replace(/\n\n/g,"\n\n    "),n=n.replace(/\n([ ]*)+(\*|\d+\.) /g,"\n$1    $2 "),a+n})}r[l]=r[l].replace(/(.) +$/m,"$1")}return r.join("\n")}),"\n\n"+e.replace(/[ \t]+\n|\s+$/g,"")}function a(e){return e=e.replace(/<blockquote\b[^>]*>([\s\S]*?)<\/blockquote>/gi,function(e,n){return n=n.replace(/^\s+|\s+$/g,""),n=i(n),n=n.replace(/^/gm,"> "),n=n.replace(/^(>([ \t]{2,}>)+)/gm,"> >")})}function i(e){return e=e.replace(/^[\t\r\n]+|[\t\r\n]+$/g,""),e=e.replace(/\n\s+\n/g,"\n\n"),e=e.replace(/\n{3,}/g,"\n\n")}for(var o=[{patterns:"p",replacement:function(e,n,t){return t?"\n\n"+t+"\n":""}},{patterns:"br",type:"void",replacement:"  \n"},{patterns:"h([1-6])",replacement:function(e,n,t,r){for(var a="",c=0;n>c;c++)a+="#";return"\n\n"+a+" "+r+"\n"}},{patterns:"hr",type:"void",replacement:"\n\n* * *\n"},{patterns:"a",replacement:function(e,n,r){var a=n.match(t("href")),c=n.match(t("title"));return a?"["+r+"]("+a[1]+(c&&c[1]?' "'+c[1]+'"':"")+")":e}},{patterns:["b","strong"],replacement:function(e,n,t){return t?"**"+t+"**":""}},{patterns:["i","em"],replacement:function(e,n,t){return t?"_"+t+"_":""}},{patterns:"code",replacement:function(e,n,t){return t?"`"+c.decode(t)+"`":""}},{patterns:"img",type:"void",replacement:function(e,n){var r=n.match(t("src")),a=n.match(t("alt")),c=n.match(t("title"));return r?"!["+(a&&a[1]?a[1]:"")+"]("+r[1]+(c&&c[1]?' "'+c[1]+'"':"")+")":""}}],l=0,s=o.length;s>l;l++)if("string"==typeof o[l].patterns)e=n(e,{tag:o[l].patterns,replacement:o[l].replacement,type:o[l].type});else for(var p=0,u=o[l].patterns.length;u>p;p++)e=n(e,{tag:o[l].patterns[p],replacement:o[l].replacement,type:o[l].type});e=e.replace(/<pre\b[^>]*>`([\s\S]*?)`<\/pre>/gi,function(e,n){var t=c.decode(n);return t=t.replace(/^\t+/g,"  "),t=t.replace(/\n/g,"\n    "),"\n\n    "+t+"\n"}),e=e.replace(/^(\s{0,3}\d+)\. /g,"$1\\. ");for(var f=/<(ul|ol)\b[^>]*>(?:(?!<ul|<ol)[\s\S])*?<\/\1>/gi;e.match(f);)e=e.replace(f,function(e){return r(e)});for(var m=/<blockquote\b[^>]*>((?:(?!<blockquote)[\s\S])*?)<\/blockquote>/gi;e.match(m);)e=e.replace(m,function(e){return a(e)});return i(e)},o=function(e,n){"function"==typeof e&&(n=e,e={}),e=Object(e),e.events=e.events||["input","change"],n=n||e.callback||function(){},this.init=function(t){if(this.me=t,this.me.elements&&this.me.elements.length){this.element=this.me.elements[0];var r=function(){n(i(this.element.innerHTML).split("\n").map(function(e){return e.trim()}).join("\n").trim())}.bind(this);e.events.forEach(function(e){this.element.addEventListener(e,r)}.bind(this)),r()}}};e.MeMarkdown=o}(this);